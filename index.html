<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>ì—°ì„¸ì„¸ë¸Œë€ìŠ¤ë¹Œë”© ì£¼ë³€ ë§›ì§‘</title>
<style>
  /* ======= Theme (ëª¨ë…¸í†¤, ë²„íŠ¼ë§Œ ì»¬ëŸ¬) ======= */
  :root{
  --bg-url: url("https://raw.githubusercontent.com/Seedcoop/test/main/seedy.jpg");
}
    --ink:#111; --sub:#6b7280; --line:#e5e7eb;
    --panel: rgba(255,255,255,.82);
    --panel-strong: rgba(255,255,255,.2);
    --shadow: 0 12px 30px rgba(0,0,0,.15);

    /* ë²„íŠ¼(ì»¬ëŸ¬ í—ˆìš©) */
    --btn-primary:#2563eb;
    --btn-success:#059669;
    --btn-warn:#f59e0b;
  }

  *{margin:0;padding:0;box-sizing:border-box}
  html,body{height:100%}
  body{
    color:var(--ink); font-family:system-ui,-apple-system,Pretendard,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    line-height:1.45;
    background:#fff;
  }
  /* ì „ì²´ ë°°ê²½ ì´ë¯¸ì§€ + ê³ ì • */
  body::before{
    content:""; position:fixed; inset:0; z-index:-2;
    background: var(--bg-url) center/contain no-repeat;
    opacity:.25; /* ì§„í•˜ê¸° ì¡°ì ˆ: 0~1 */
  }
  /* ì‚´ì§ í†¤ë³´ì •ìš© ê·¸ë ˆì´ ì˜¤ë²„ë ˆì´ (í•„ìš” ì—†ìœ¼ë©´ íˆ¬ëª…ë„ë¡œ ë‚®ì¶”ê¸°) */
  body::after{
    content:""; position:fixed; inset:0; z-index:-1;
    background: radial-gradient(1000px 600px at 50% 10%, rgba(255,255,255,.35), rgba(255,255,255,.55));
  }

  .container{max-width:1200px;margin:0 auto;padding:20px}
  .header, .panel{background:var(--panel); border:1px solid var(--line); border-radius:18px; box-shadow:var(--shadow); backdrop-filter: blur(6px)}
  .header{padding:28px; text-align:center; margin-bottom:16px}
  .header h1{font-size:2rem; font-weight:800; margin-bottom:6px}
  .header p{color:var(--sub)}

  .toolbar{display:grid;gap:12px;padding:14px}
  .row{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
  .label-strong{font-weight:800; min-width:70px}

  /* ëª¨ë…¸í†¤ ì¹©/í•„í„° */
  .chip {
  padding:10px 14px;
  border:1px solid rgba(0,0,0,.1);
  border-radius:999px;
  background:rgba(255,255,255,.6); /* ê¸°ë³¸: ë°˜íˆ¬ëª… í°ìƒ‰ */
  color:#111;
  font-weight:700;
  cursor:pointer;
  transition:.15s;
  backdrop-filter: blur(4px);   /* ìœ ë¦¬íš¨ê³¼ */
}
.chip[aria-pressed="true"] {
  background:rgba(0,0,0,.8);   /* ëˆŒë €ì„ ë•Œ: ê²€ì€ìƒ‰ */
  color:#fff;
  border-color:rgba(0,0,0,.8);
}

.search {
  flex:1; min-width:220px; display:flex; gap:8px;
}
input[type="search"], select {
  width:100%;
  padding:12px;
  border:1.5px solid #d1d5db;   /* ì—°í•œ íšŒìƒ‰ */
  border-radius:12px;
  background:#f9fafb;           /* ì—°íšŒìƒ‰ ë°°ê²½ */
  color:#111;
}
input[type="search"]:focus, select:focus {
  outline:none;
  border-color:#9ca3af;         /* í¬ì»¤ìŠ¤ ì‹œ ì§„í•œ íšŒìƒ‰ */
}
  /* ë²„íŠ¼ë§Œ ì»¬ëŸ¬ */
.btn {
  padding:12px 16px;
  border:none;
  border-radius:12px;
  font-weight:800;
  cursor:pointer;
  background:#e5e7eb;   /* ê¸°ë³¸ íšŒìƒ‰ */
  color:#111;
  transition:.15s;
}
.btn:hover {
  background:#d1d5db;   /* hover ì‹œ ì§„í•´ì§ */
}
.btn:focus {
  outline:2px solid #000;
  outline-offset:2px;
}

  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr)); gap:14px; margin-top:12px}
  .card{background:var(--panel-strong); border:1px solid var(--line); border-left:4px solid #111; border-radius:14px; padding:16px; box-shadow:var(--shadow); transition:.15s}
  .card:hover{transform:translateY(-2px)}
  .name{font-size:1.15rem; font-weight:800; margin-bottom:6px}
  .rowline{display:flex;gap:8px;align-items:center;margin:6px 0}
  .key{color:var(--sub); min-width:54px; font-weight:700}
  .badge{display:inline-block; padding:6px 10px; border-radius:999px; border:1px solid var(--line); background:#fff; font-size:.85rem; font-weight:800; color:#111}
  .distance{font-weight:800}

  /* ëœë¤ ì¶”ì²œ ë°•ìŠ¤ë„ ëª¨ë…¸í†¤ */
  .random{display:none;background:rgba(255,255,255,.9); border:1px solid var(--line); border-radius:14px; padding:16px}

  /* ëª¨ë‹¬(ë°˜íˆ¬ëª… íŒ¨ë„) */
  dialog{border:none;border-radius:16px;box-shadow:var(--shadow); max-width:520px; width:90%; background:var(--panel); backdrop-filter: blur(6px)}
  dialog::backdrop{background:rgba(0,0,0,.35)}
  form .grp{margin-bottom:12px}
  form label{display:block;font-weight:800;margin-bottom:6px}
  form input, form select{width:100%; padding:12px; border:1.5px solid var(--line); border-radius:12px; background:#fff}
  .submit{width:100%; padding:14px; border:none; border-radius:12px; background:var(--btn-primary); color:#fff; font-weight:900}

  /* í† ìŠ¤íŠ¸ */
  .toast{position:fixed;bottom:16px;left:50%;transform:translateX(-50%);
    background:#111;color:#fff;padding:10px 14px;border-radius:10px;opacity:0;pointer-events:none;transition:.25s}
  .toast.show{opacity:1}

  @media (max-width:768px){
    .header h1{font-size:1.6rem}
    .grid{grid-template-columns:1fr}
  }
</style>
</head>
<body>
  <div class="container">
    <header class="header">
      <h1>ğŸ½ï¸ ì—°ì„¸ì„¸ë¸Œë€ìŠ¤ë¹Œë”© ì£¼ë³€ ë§›ì§‘</h1>
      <p>í•„í„°Â·ê²€ìƒ‰Â·ì •ë ¬Â·ëœë¤ ì¶”ì²œ</p>
    </header>

    <section class="panel toolbar" aria-label="í•„í„°ì™€ ë„êµ¬">
      <div class="row">
        <div class="label-strong">ğŸœ ì¢…ë¥˜</div>
        <div id="catFilters" role="group" aria-label="ì¢…ë¥˜ í•„í„°"></div>
      </div>

      <div class="row">
        <div class="label-strong">ğŸ’° ê°€ê²©</div>
        <div id="priceFilters" role="group" aria-label="ê°€ê²© í•„í„°"></div>
      </div>

      <div class="row">
        <div class="search" role="search">
          <input id="q" type="search" placeholder="ì‹ë‹¹ëª…Â·ë©”ë‰´ ê²€ìƒ‰ (ì˜ˆ: ëƒ‰ë©´/ìš°ë™/ì‚¼ê²¹ì‚´)" aria-label="ê²€ìƒ‰"/>
          <select id="sorter" aria-label="ì •ë ¬">
            <option value="distance.asc">ê±°ë¦¬ â†‘</option>
            <option value="price.asc">ê°€ê²© â†‘</option>
            <option value="price.desc">ê°€ê²© â†“</option>
            <option value="name.asc">ì´ë¦„ â†‘</option>
          </select>
        </div>
        <div class="row" style="gap:8px">
          <button id="btnRandom" class="btn btn-warn" type="button">ğŸ² ëœë¤</button>
          <button id="btnAdd" class="btn btn-success" type="button">â• ì¶”ê°€</button>
          <button id="btnUpdate" class="btn btn-primary" type="button">ğŸ”„ ì—…ë°ì´íŠ¸</button>
        </div>
      </div>

      <div id="randomBox" class="random" role="status" aria-live="polite"></div>
    </section>

    <section class="panel">
      <div id="grid" class="grid" aria-live="polite" aria-busy="false"></div>
    </section>
  </div>

  <!-- Add Modal -->
  <dialog id="addDlg" aria-labelledby="addTitle">
    <form id="addForm" method="dialog">
      <h2 id="addTitle" style="margin-bottom:8px">ğŸª ìƒˆ ì‹ë‹¹ ì¶”ê°€</h2>
      <div class="grp"><label for="name">ì‹ë‹¹ ì´ë¦„</label><input id="name" required maxlength="40"/></div>
      <div class="grp"><label for="menu">ì£¼ ë©”ë‰´</label><input id="menu" required maxlength="40"/></div>
      <div class="grp">
        <label for="cat">ìŒì‹ ì¢…ë¥˜</label>
        <select id="cat" required>
          <option value="">ì„ íƒí•˜ì„¸ìš”</option>
          <option value="korean">í•œì‹</option><option value="japanese">ì¼ì‹</option>
          <option value="chinese">ì¤‘ì‹</option><option value="western">ì–‘ì‹</option><option value="other">ê¸°íƒ€</option>
        </select>
      </div>
      <div class="grp"><label for="price">í‰ê·  ê°€ê²©(ì›)</label><input id="price" type="number" min="0" step="100" required/></div>
      <div class="grp"><label for="dist">ê±°ë¦¬(ë„ë³´ ë¶„)</label><input id="dist" type="number" min="1" max="120" required/></div>
      <button class="submit" type="submit">ì¶”ê°€í•˜ê¸°</button>
    </form>
  </dialog>

  <div id="toast" class="toast" role="status" aria-live="polite">ì™„ë£Œ</div>

<script>
/* ======= JS ======= */
const $ = (s,r=document)=>r.querySelector(s);
const $$ = (s,r=document)=>[...r.querySelectorAll(s)];
const toast = (m)=>{const t=$("#toast"); t.textContent=m; t.classList.add("show"); setTimeout(()=>t.classList.remove("show"),1300)};
const formatWon = n => (Number(n)||0).toLocaleString()+"ì›";
const normalize = s => (s||"").toString().trim().toLowerCase();
const clampInt = (v,min,max)=>Math.max(min,Math.min(max,Math.round(Number(v)||0)));

const seed = [
  {name:'ëª…ë™ì§‘',menu:'ê¸‰ëƒ‰ ì‚¼ê²¹ì‚´',category:'korean',price:15000,distance:5},
  {name:'ì„œìš¸ì—­ êµ¬ë‚´ì‹ë‹¹',menu:'í•œì‹ ì •ì‹',category:'korean',price:6500,distance:5},
  {name:'ì„œë¦¬ì¬',menu:'ì†¥ë°¥',category:'korean',price:12000,distance:5},
  {name:'í† ë¼ì •',menu:'í¬ë¦¼ ì¹´ë ˆ ìš°ë™',category:'japanese',price:11000,distance:5},
  {name:'ëˆ„ë“¤í‚¹',menu:'ìš°ë™',category:'japanese',price:9000,distance:5},
  {name:'ë”í”Œë ˆì´ìŠ¤',menu:'í­íƒ„í”¼ì',category:'western',price:18000,distance:7},
  {name:'ëˆìˆ˜ë°±',menu:'ë¼ì§€êµ­ë°¥',category:'korean',price:8000,distance:8},
  {name:'íˆ¬ë¿”ë“±ì‹¬',menu:'í•œìš° ë“±ì‹¬',category:'korean',price:35000,distance:7},
  {name:'í˜¸ìˆ˜ì§‘',menu:'ë‹­ê¼¬ì¹˜',category:'korean',price:13000,distance:10},
  {name:'í¬ë½ê°ˆì¹˜',menu:'ê°ˆì¹˜ì¡°ë¦¼',category:'korean',price:14000,distance:12},
  {name:'ì€í˜¸ì‹ë‹¹',menu:'ê¼¬ë¦¬ê³°íƒ•',category:'korean',price:17000,distance:12},
  {name:'ë§‰ë‚´íšŒì§‘',menu:'íšŒ',category:'korean',price:25000,distance:12},
  {name:'ê°€ë©”ê³¨ì†ì™•ë§Œë‘',menu:'ì™•ë§Œë‘',category:'chinese',price:9000,distance:12},
  {name:'êµ¬ë³µë§Œë‘',menu:'ì¤‘êµ­ì‹ ë§Œë‘',category:'chinese',price:10000,distance:12},
  {name:'ë¶€ì›ë©´ì˜¥',menu:'í‰ì–‘ëƒ‰ë©´',category:'korean',price:12000,distance:13},
  {name:'ì¶©ë¬´ì¹¼êµ­ìˆ˜',menu:'ì¹¼êµ­ìˆ˜',category:'korean',price:8000,distance:13},
  {name:'ë‹­ì§„ë¯¸ê°•ì›ì§‘',menu:'ë‹­ê³°íƒ•',category:'korean',price:11000,distance:12},
  {name:'í’ë…„ì˜¥',menu:'ì„¤ë íƒ•',category:'korean',price:10000,distance:13},
  {name:'ì˜ë‚¨ì§‘',menu:'ë‹­ê³°íƒ•',category:'korean',price:9500,distance:13},
  {name:'í˜ì´ì•¼ë“œ',menu:'ë””ì €íŠ¸',category:'other',price:8000,distance:12},
  {name:'ìœ ì¦ˆë¼ë©˜',menu:'ìœ ì¦ˆì‹œì˜¤ë¼ë©˜',category:'japanese',price:12000,distance:15},
  {name:'ë§Œë¦¬ì¬ ë¹„ìŠ¤íŠ¸ë¡œ',menu:'í™”ë•í”¼ì',category:'western',price:20000,distance:15},
  {name:'ê°ˆì›”ì´ê³¨ëª©',menu:'íŒŒìŠ¤íƒ€',category:'western',price:16000,distance:16},
  {name:'í¬ì»¬í¬ì¸íŠ¸',menu:'ë² ì´ì»¤ë¦¬',category:'other',price:7000,distance:15},
  {name:'íŒŒì´ë¸Œê°€ì´ì¦ˆ',menu:'ìˆ˜ì œë²„ê±°',category:'western',price:14000,distance:15},
  {name:'ì„ì§€ë©´ì˜¥',menu:'í‰ì–‘ëƒ‰ë©´',category:'korean',price:13000,distance:18},
  {name:'ì•ˆë™ì¥',menu:'ì§œì¥ë©´',category:'chinese',price:8000,distance:18},
  {name:'ê°œí™”',menu:'ì¤‘ì‹',category:'chinese',price:15000,distance:18},
  {name:'ì „ì£¼ì§‘',menu:'ì–‘ë…ê°ˆë¹„',category:'korean',price:22000,distance:18},
  {name:'ì„œìš¸ë¶€ë ë„',menu:'í“¨ì „ìš”ë¦¬',category:'other',price:25000,distance:16}
];
const LS_KEY="ys_sev_restaurants_v2";
let restaurants = load();
function load(){
  const saved = JSON.parse(localStorage.getItem(LS_KEY)||"[]");
  const map = new Map();
  [...seed,...saved].forEach(r=>{
    const k = normalize(r.name);
    if(!map.has(k)) map.set(k,{...r});
  });
  return [...map.values()];
}
function persist(){
  const seedNames = new Set(seed.map(s=>normalize(s.name)));
  const custom = restaurants.filter(r=>!seedNames.has(normalize(r.name)));
  localStorage.setItem(LS_KEY, JSON.stringify(custom));
}

const catDef = [
  {val:"all", label:"ì „ì²´"},
  {val:"korean", label:"í•œì‹"},
  {val:"japanese", label:"ì¼ì‹"},
  {val:"chinese", label:"ì¤‘ì‹"},
  {val:"western", label:"ì–‘ì‹"},
  {val:"other", label:"ê¸°íƒ€"}
];
const priceDef = [
  {val:"all", label:"ì „ì²´"},
  {val:"under10", label:"1ë§Œì› ì´í•˜"},
  {val:"10s", label:"1ë§Œì›ëŒ€"},
  {val:"20s", label:"2ë§Œì›ëŒ€"},
  {val:"over20", label:"2ë§Œì› ì´ìƒ"}
];
const state = { category:"all", price:"all", query:"", sort:"distance.asc" };

function buildChips(el, items, group){
  el.innerHTML = items.map((it,i)=>(
    `<button class="chip" type="button" data-group="${group}" data-val="${it.val}" aria-pressed="${i===0?'true':'false'}">${it.label}</button>`
  )).join("");
}
buildChips($("#catFilters"), catDef, "cat");
buildChips($("#priceFilters"), priceDef, "price");

function inPriceRange(p, rng){
  switch(rng){
    case "under10": return p<10000;
    case "10s": return p>=10000 && p<20000;
    case "20s": return p>=20000 && p<30000;
    case "over20": return p>=30000;
    default: return true;
  }
}
const catName = c => ({korean:"í•œì‹",japanese:"ì¼ì‹",chinese:"ì¤‘ì‹",western:"ì–‘ì‹",other:"ê¸°íƒ€"})[c]||c;

function applyFilters(){
  const qn = normalize(state.query);
  let list = restaurants.filter(r=>{
    const catOk = state.category==="all" || r.category===state.category;
    const priceOk = state.price==="all" || inPriceRange(r.price,state.price);
    const qOk = !qn || normalize(r.name).includes(qn) || normalize(r.menu).includes(qn);
    return catOk && priceOk && qOk;
  });
  const [key,dir] = state.sort.split(".");
  list.sort((a,b)=>{
    const keyer = {distance:x=>x.distance, price:x=>x.price, name:x=>normalize(x.name)}[key];
    const av=keyer(a), bv=keyer(b);
    if(av<bv) return dir==="asc"?-1:1;
    if(av>bv) return dir==="asc"?1:-1;
    return 0;
  });
  return list;
}

function mapLink(name){
  const q = encodeURIComponent(name);
  return {
    search:`https://m.map.naver.com/search2/search.naver?query=${q}`,
    route:`https://map.naver.com/v5/directions/-/-/${q}`
  };
}

function render(){
  $("#grid").setAttribute("aria-busy","true");
  const list = applyFilters();
  $("#grid").innerHTML = list.map(r=>{
    const links = mapLink(r.name);
    return `<article class="card" tabindex="0">
      <div class="name">${r.name}</div>
      <div class="rowline"><span class="key">ë©”ë‰´</span><span>${r.menu}</span></div>
      <div class="rowline"><span class="key">ì¢…ë¥˜</span><span class="badge">${catName(r.category)}</span></div>
      <div class="rowline"><span class="key">ê°€ê²©</span><span class="badge">${formatWon(r.price)}</span></div>
      <div class="rowline"><span class="key">ê±°ë¦¬</span><span class="distance">ğŸš¶ ${r.distance}ë¶„</span></div>
      <div class="rowline" style="gap:12px">
        <a href="${links.search}" target="_blank" rel="noopener">ë„¤ì´ë²„ ê²€ìƒ‰</a>
        <a href="${links.route}" target="_blank" rel="noopener">ê¸¸ì°¾ê¸°</a>
      </div>
    </article>`;
  }).join("") || `<div style="padding:16px">ì¡°ê±´ì— ë§ëŠ” ì‹ë‹¹ì´ ì—†ìŠµë‹ˆë‹¤.</div>`;
  $("#grid").setAttribute("aria-busy","false");
}
render();

/* ì´ë²¤íŠ¸ */
$("#catFilters").addEventListener("click",e=>{
  const btn = e.target.closest(".chip"); if(!btn) return;
  $$("#catFilters .chip").forEach(b=>b.setAttribute("aria-pressed","false"));
  btn.setAttribute("aria-pressed","true");
  state.category = btn.dataset.val;
  render();
});
$("#priceFilters").addEventListener("click",e=>{
  const btn = e.target.closest(".chip"); if(!btn) return;
  $$("#priceFilters .chip").forEach(b=>b.setAttribute("aria-pressed","false"));
  btn.setAttribute("aria-pressed","true");
  state.price = btn.dataset.val;
  render();
});
let tId;
$("#q").addEventListener("input",e=>{
  clearTimeout(tId);
  tId=setTimeout(()=>{state.query=e.target.value; render();},160);
});
$("#sorter").addEventListener("change",e=>{state.sort=e.target.value; render();});

/* ëœë¤ */
$("#btnRandom").addEventListener("click",()=>{
  const list = applyFilters();
  if(!list.length){ $("#randomBox").style.display="none"; toast("ì¡°ê±´ì— ë§ëŠ” ì‹ë‹¹ì´ ì—†ì–´ìš”"); return; }
  const r = list[Math.floor(Math.random()*list.length)];
  $("#randomBox").innerHTML = `<div><strong>ğŸ¯ ì˜¤ëŠ˜ì˜ ì¶”ì²œ</strong></div>
    <div style="margin-top:6px">${r.name} Â· ${r.menu} Â· ${catName(r.category)} Â· ${formatWon(r.price)} Â· ğŸš¶ ${r.distance}ë¶„</div>`;
  $("#randomBox").style.display="block";
  $("#randomBox").scrollIntoView({behavior:"smooth",block:"center"});
});

/* ê°€ì§œ ì—…ë°ì´íŠ¸ */
$("#btnUpdate").addEventListener("click",async()=>{
  toast("ì—…ë°ì´íŠ¸â€¦");
  await new Promise(r=>setTimeout(r,500));
  const incoming = [
    {name:"ìƒˆë¡œìš´ ë§›ì§‘ 1",menu:"íŠ¹ì œ ë®ë°¥",category:"korean",price:12000,distance:8},
    {name:"ìƒˆë¡œìš´ ë§›ì§‘ 2",menu:"ë¼ë©˜",category:"japanese",price:13000,distance:10}
  ];
  let added=0;
  incoming.forEach(n=>{
    if(!restaurants.some(r=>normalize(r.name)===normalize(n.name))){
      restaurants.push(n); added++;
    }
  });
  if(added){ persist(); render(); }
  toast(`${added}ê°œ ì¶”ê°€ë¨`);
});

/* ì¶”ê°€ ëª¨ë‹¬ */
const dlg = $("#addDlg");
$("#btnAdd").addEventListener("click",()=>dlg.showModal());
$("#addForm").addEventListener("submit",(e)=>{
  e.preventDefault();
  const name=$("#name").value, menu=$("#menu").value, category=$("#cat").value;
  const price=clampInt($("#price").value,0,1_000_000), distance=clampInt($("#dist").value,1,120);
  if(!name||!menu||!category){ toast("ì…ë ¥ê°’ì„ í™•ì¸í•˜ì„¸ìš”"); return; }
  if(restaurants.some(r=>normalize(r.name)===normalize(name))){ toast("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì‹ë‹¹"); return; }
  restaurants.push({name:name.trim(),menu:menu.trim(),category,price,distance});
  persist(); render(); dlg.close(); e.target.reset(); toast("ì¶”ê°€ ì™„ë£Œ");
});

/* ë‹¨ì¶•í‚¤: / ë¡œ ê²€ìƒ‰ í¬ì»¤ìŠ¤ */
window.addEventListener("keydown",(e)=>{
  if(e.key==="/" && document.activeElement!==$("#q")){ e.preventDefault(); $("#q").focus(); }
});
</script>
</body>
</html>
