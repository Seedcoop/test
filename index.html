<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>연세세브란스빌딩 주변 맛집</title>
<style>
  /* ======= Theme (모노톤, 버튼만 컬러) ======= */
  :root{
  --bg-url: url("https://raw.githubusercontent.com/Seedcoop/test/main/seedy.jpg");
}
    --ink:#111; --sub:#6b7280; --line:#e5e7eb;
    --panel: rgba(255,255,255,.82);
    --panel-strong: rgba(255,255,255,.2);
    --shadow: 0 12px 30px rgba(0,0,0,.15);

    /* 버튼(컬러 허용) */
    --btn-primary:#2563eb;
    --btn-success:#059669;
    --btn-warn:#f59e0b;
  }

  *{margin:0;padding:0;box-sizing:border-box}
  html,body{height:100%}
  body{
    color:var(--ink); font-family:system-ui,-apple-system,Pretendard,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    line-height:1.45;
    background:#fff;
  }
  /* 전체 배경 이미지 + 고정 */
  body::before{
    content:""; position:fixed; inset:0; z-index:-2;
    background: var(--bg-url) center/contain no-repeat;
    opacity:.25; /* 진하기 조절: 0~1 */
  }
  /* 살짝 톤보정용 그레이 오버레이 (필요 없으면 투명도로 낮추기) */
  body::after{
    content:""; position:fixed; inset:0; z-index:-1;
    background: radial-gradient(1000px 600px at 50% 10%, rgba(255,255,255,.35), rgba(255,255,255,.55));
  }

  .container{max-width:1200px;margin:0 auto;padding:20px}
  .header, .panel{background:var(--panel); border:1px solid var(--line); border-radius:18px; box-shadow:var(--shadow); backdrop-filter: blur(6px)}
  .header{padding:28px; text-align:center; margin-bottom:16px}
  .header h1{font-size:2rem; font-weight:800; margin-bottom:6px}
  .header p{color:var(--sub)}

  .toolbar{display:grid;gap:12px;padding:14px}
  .row{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
  .label-strong{font-weight:800; min-width:70px}

  /* 모노톤 칩/필터 */
  .chip {
  padding:10px 14px;
  border:1px solid rgba(0,0,0,.1);
  border-radius:999px;
  background:rgba(255,255,255,.6); /* 기본: 반투명 흰색 */
  color:#111;
  font-weight:700;
  cursor:pointer;
  transition:.15s;
  backdrop-filter: blur(4px);   /* 유리효과 */
}
.chip[aria-pressed="true"] {
  background:rgba(0,0,0,.8);   /* 눌렀을 때: 검은색 */
  color:#fff;
  border-color:rgba(0,0,0,.8);
}

.search {
  flex:1; min-width:220px; display:flex; gap:8px;
}
input[type="search"], select {
  width:100%;
  padding:12px;
  border:1.5px solid #d1d5db;   /* 연한 회색 */
  border-radius:12px;
  background:#f9fafb;           /* 연회색 배경 */
  color:#111;
}
input[type="search"]:focus, select:focus {
  outline:none;
  border-color:#9ca3af;         /* 포커스 시 진한 회색 */
}
  /* 버튼만 컬러 */
.btn {
  padding:12px 16px;
  border:none;
  border-radius:12px;
  font-weight:800;
  cursor:pointer;
  background:#e5e7eb;   /* 기본 회색 */
  color:#111;
  transition:.15s;
}
.btn:hover {
  background:#d1d5db;   /* hover 시 진해짐 */
}
.btn:focus {
  outline:2px solid #000;
  outline-offset:2px;
}

  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr)); gap:14px; margin-top:12px}
  .card{background:var(--panel-strong); border:1px solid var(--line); border-left:4px solid #111; border-radius:14px; padding:16px; box-shadow:var(--shadow); transition:.15s}
  .card:hover{transform:translateY(-2px)}
  .name{font-size:1.15rem; font-weight:800; margin-bottom:6px}
  .rowline{display:flex;gap:8px;align-items:center;margin:6px 0}
  .key{color:var(--sub); min-width:54px; font-weight:700}
  .badge{display:inline-block; padding:6px 10px; border-radius:999px; border:1px solid var(--line); background:#fff; font-size:.85rem; font-weight:800; color:#111}
  .distance{font-weight:800}

  /* 랜덤 추천 박스도 모노톤 */
  .random{display:none;background:rgba(255,255,255,.9); border:1px solid var(--line); border-radius:14px; padding:16px}

  /* 모달(반투명 패널) */
  dialog{border:none;border-radius:16px;box-shadow:var(--shadow); max-width:520px; width:90%; background:var(--panel); backdrop-filter: blur(6px)}
  dialog::backdrop{background:rgba(0,0,0,.35)}
  form .grp{margin-bottom:12px}
  form label{display:block;font-weight:800;margin-bottom:6px}
  form input, form select{width:100%; padding:12px; border:1.5px solid var(--line); border-radius:12px; background:#fff}
  .submit{width:100%; padding:14px; border:none; border-radius:12px; background:var(--btn-primary); color:#fff; font-weight:900}

  /* 토스트 */
  .toast{position:fixed;bottom:16px;left:50%;transform:translateX(-50%);
    background:#111;color:#fff;padding:10px 14px;border-radius:10px;opacity:0;pointer-events:none;transition:.25s}
  .toast.show{opacity:1}

  @media (max-width:768px){
    .header h1{font-size:1.6rem}
    .grid{grid-template-columns:1fr}
  }
</style>
</head>
<body>
  <div class="container">
    <header class="header">
      <h1>🍽️ 연세세브란스빌딩 주변 맛집</h1>
      <p>필터·검색·정렬·랜덤 추천</p>
    </header>

    <section class="panel toolbar" aria-label="필터와 도구">
      <div class="row">
        <div class="label-strong">🍜 종류</div>
        <div id="catFilters" role="group" aria-label="종류 필터"></div>
      </div>

      <div class="row">
        <div class="label-strong">💰 가격</div>
        <div id="priceFilters" role="group" aria-label="가격 필터"></div>
      </div>

      <div class="row">
        <div class="search" role="search">
          <input id="q" type="search" placeholder="식당명·메뉴 검색 (예: 냉면/우동/삼겹살)" aria-label="검색"/>
          <select id="sorter" aria-label="정렬">
            <option value="distance.asc">거리 ↑</option>
            <option value="price.asc">가격 ↑</option>
            <option value="price.desc">가격 ↓</option>
            <option value="name.asc">이름 ↑</option>
          </select>
        </div>
        <div class="row" style="gap:8px">
          <button id="btnRandom" class="btn btn-warn" type="button">🎲 랜덤</button>
          <button id="btnAdd" class="btn btn-success" type="button">➕ 추가</button>
          <button id="btnUpdate" class="btn btn-primary" type="button">🔄 업데이트</button>
        </div>
      </div>

      <div id="randomBox" class="random" role="status" aria-live="polite"></div>
    </section>

    <section class="panel">
      <div id="grid" class="grid" aria-live="polite" aria-busy="false"></div>
    </section>
  </div>

  <!-- Add Modal -->
  <dialog id="addDlg" aria-labelledby="addTitle">
    <form id="addForm" method="dialog">
      <h2 id="addTitle" style="margin-bottom:8px">🏪 새 식당 추가</h2>
      <div class="grp"><label for="name">식당 이름</label><input id="name" required maxlength="40"/></div>
      <div class="grp"><label for="menu">주 메뉴</label><input id="menu" required maxlength="40"/></div>
      <div class="grp">
        <label for="cat">음식 종류</label>
        <select id="cat" required>
          <option value="">선택하세요</option>
          <option value="korean">한식</option><option value="japanese">일식</option>
          <option value="chinese">중식</option><option value="western">양식</option><option value="other">기타</option>
        </select>
      </div>
      <div class="grp"><label for="price">평균 가격(원)</label><input id="price" type="number" min="0" step="100" required/></div>
      <div class="grp"><label for="dist">거리(도보 분)</label><input id="dist" type="number" min="1" max="120" required/></div>
      <button class="submit" type="submit">추가하기</button>
    </form>
  </dialog>

  <div id="toast" class="toast" role="status" aria-live="polite">완료</div>

<script>
/* ======= JS ======= */
const $ = (s,r=document)=>r.querySelector(s);
const $$ = (s,r=document)=>[...r.querySelectorAll(s)];
const toast = (m)=>{const t=$("#toast"); t.textContent=m; t.classList.add("show"); setTimeout(()=>t.classList.remove("show"),1300)};
const formatWon = n => (Number(n)||0).toLocaleString()+"원";
const normalize = s => (s||"").toString().trim().toLowerCase();
const clampInt = (v,min,max)=>Math.max(min,Math.min(max,Math.round(Number(v)||0)));

const seed = [
  {name:'명동집',menu:'급냉 삼겹살',category:'korean',price:15000,distance:5},
  {name:'서울역 구내식당',menu:'한식 정식',category:'korean',price:6500,distance:5},
  {name:'서리재',menu:'솥밥',category:'korean',price:12000,distance:5},
  {name:'토끼정',menu:'크림 카레 우동',category:'japanese',price:11000,distance:5},
  {name:'누들킹',menu:'우동',category:'japanese',price:9000,distance:5},
  {name:'더플레이스',menu:'폭탄피자',category:'western',price:18000,distance:7},
  {name:'돈수백',menu:'돼지국밥',category:'korean',price:8000,distance:8},
  {name:'투뿔등심',menu:'한우 등심',category:'korean',price:35000,distance:7},
  {name:'호수집',menu:'닭꼬치',category:'korean',price:13000,distance:10},
  {name:'희락갈치',menu:'갈치조림',category:'korean',price:14000,distance:12},
  {name:'은호식당',menu:'꼬리곰탕',category:'korean',price:17000,distance:12},
  {name:'막내회집',menu:'회',category:'korean',price:25000,distance:12},
  {name:'가메골손왕만두',menu:'왕만두',category:'chinese',price:9000,distance:12},
  {name:'구복만두',menu:'중국식 만두',category:'chinese',price:10000,distance:12},
  {name:'부원면옥',menu:'평양냉면',category:'korean',price:12000,distance:13},
  {name:'충무칼국수',menu:'칼국수',category:'korean',price:8000,distance:13},
  {name:'닭진미강원집',menu:'닭곰탕',category:'korean',price:11000,distance:12},
  {name:'풍년옥',menu:'설렁탕',category:'korean',price:10000,distance:13},
  {name:'영남집',menu:'닭곰탕',category:'korean',price:9500,distance:13},
  {name:'페이야드',menu:'디저트',category:'other',price:8000,distance:12},
  {name:'유즈라멘',menu:'유즈시오라멘',category:'japanese',price:12000,distance:15},
  {name:'만리재 비스트로',menu:'화덕피자',category:'western',price:20000,distance:15},
  {name:'갈월이골목',menu:'파스타',category:'western',price:16000,distance:16},
  {name:'포컬포인트',menu:'베이커리',category:'other',price:7000,distance:15},
  {name:'파이브가이즈',menu:'수제버거',category:'western',price:14000,distance:15},
  {name:'을지면옥',menu:'평양냉면',category:'korean',price:13000,distance:18},
  {name:'안동장',menu:'짜장면',category:'chinese',price:8000,distance:18},
  {name:'개화',menu:'중식',category:'chinese',price:15000,distance:18},
  {name:'전주집',menu:'양념갈비',category:'korean',price:22000,distance:18},
  {name:'서울부띠끄',menu:'퓨전요리',category:'other',price:25000,distance:16}
];
const LS_KEY="ys_sev_restaurants_v2";
let restaurants = load();
function load(){
  const saved = JSON.parse(localStorage.getItem(LS_KEY)||"[]");
  const map = new Map();
  [...seed,...saved].forEach(r=>{
    const k = normalize(r.name);
    if(!map.has(k)) map.set(k,{...r});
  });
  return [...map.values()];
}
function persist(){
  const seedNames = new Set(seed.map(s=>normalize(s.name)));
  const custom = restaurants.filter(r=>!seedNames.has(normalize(r.name)));
  localStorage.setItem(LS_KEY, JSON.stringify(custom));
}

const catDef = [
  {val:"all", label:"전체"},
  {val:"korean", label:"한식"},
  {val:"japanese", label:"일식"},
  {val:"chinese", label:"중식"},
  {val:"western", label:"양식"},
  {val:"other", label:"기타"}
];
const priceDef = [
  {val:"all", label:"전체"},
  {val:"under10", label:"1만원 이하"},
  {val:"10s", label:"1만원대"},
  {val:"20s", label:"2만원대"},
  {val:"over20", label:"2만원 이상"}
];
const state = { category:"all", price:"all", query:"", sort:"distance.asc" };

function buildChips(el, items, group){
  el.innerHTML = items.map((it,i)=>(
    `<button class="chip" type="button" data-group="${group}" data-val="${it.val}" aria-pressed="${i===0?'true':'false'}">${it.label}</button>`
  )).join("");
}
buildChips($("#catFilters"), catDef, "cat");
buildChips($("#priceFilters"), priceDef, "price");

function inPriceRange(p, rng){
  switch(rng){
    case "under10": return p<10000;
    case "10s": return p>=10000 && p<20000;
    case "20s": return p>=20000 && p<30000;
    case "over20": return p>=30000;
    default: return true;
  }
}
const catName = c => ({korean:"한식",japanese:"일식",chinese:"중식",western:"양식",other:"기타"})[c]||c;

function applyFilters(){
  const qn = normalize(state.query);
  let list = restaurants.filter(r=>{
    const catOk = state.category==="all" || r.category===state.category;
    const priceOk = state.price==="all" || inPriceRange(r.price,state.price);
    const qOk = !qn || normalize(r.name).includes(qn) || normalize(r.menu).includes(qn);
    return catOk && priceOk && qOk;
  });
  const [key,dir] = state.sort.split(".");
  list.sort((a,b)=>{
    const keyer = {distance:x=>x.distance, price:x=>x.price, name:x=>normalize(x.name)}[key];
    const av=keyer(a), bv=keyer(b);
    if(av<bv) return dir==="asc"?-1:1;
    if(av>bv) return dir==="asc"?1:-1;
    return 0;
  });
  return list;
}

function mapLink(name){
  const q = encodeURIComponent(name);
  return {
    search:`https://m.map.naver.com/search2/search.naver?query=${q}`,
    route:`https://map.naver.com/v5/directions/-/-/${q}`
  };
}

function render(){
  $("#grid").setAttribute("aria-busy","true");
  const list = applyFilters();
  $("#grid").innerHTML = list.map(r=>{
    const links = mapLink(r.name);
    return `<article class="card" tabindex="0">
      <div class="name">${r.name}</div>
      <div class="rowline"><span class="key">메뉴</span><span>${r.menu}</span></div>
      <div class="rowline"><span class="key">종류</span><span class="badge">${catName(r.category)}</span></div>
      <div class="rowline"><span class="key">가격</span><span class="badge">${formatWon(r.price)}</span></div>
      <div class="rowline"><span class="key">거리</span><span class="distance">🚶 ${r.distance}분</span></div>
      <div class="rowline" style="gap:12px">
        <a href="${links.search}" target="_blank" rel="noopener">네이버 검색</a>
        <a href="${links.route}" target="_blank" rel="noopener">길찾기</a>
      </div>
    </article>`;
  }).join("") || `<div style="padding:16px">조건에 맞는 식당이 없습니다.</div>`;
  $("#grid").setAttribute("aria-busy","false");
}
render();

/* 이벤트 */
$("#catFilters").addEventListener("click",e=>{
  const btn = e.target.closest(".chip"); if(!btn) return;
  $$("#catFilters .chip").forEach(b=>b.setAttribute("aria-pressed","false"));
  btn.setAttribute("aria-pressed","true");
  state.category = btn.dataset.val;
  render();
});
$("#priceFilters").addEventListener("click",e=>{
  const btn = e.target.closest(".chip"); if(!btn) return;
  $$("#priceFilters .chip").forEach(b=>b.setAttribute("aria-pressed","false"));
  btn.setAttribute("aria-pressed","true");
  state.price = btn.dataset.val;
  render();
});
let tId;
$("#q").addEventListener("input",e=>{
  clearTimeout(tId);
  tId=setTimeout(()=>{state.query=e.target.value; render();},160);
});
$("#sorter").addEventListener("change",e=>{state.sort=e.target.value; render();});

/* 랜덤 */
$("#btnRandom").addEventListener("click",()=>{
  const list = applyFilters();
  if(!list.length){ $("#randomBox").style.display="none"; toast("조건에 맞는 식당이 없어요"); return; }
  const r = list[Math.floor(Math.random()*list.length)];
  $("#randomBox").innerHTML = `<div><strong>🎯 오늘의 추천</strong></div>
    <div style="margin-top:6px">${r.name} · ${r.menu} · ${catName(r.category)} · ${formatWon(r.price)} · 🚶 ${r.distance}분</div>`;
  $("#randomBox").style.display="block";
  $("#randomBox").scrollIntoView({behavior:"smooth",block:"center"});
});

/* 가짜 업데이트 */
$("#btnUpdate").addEventListener("click",async()=>{
  toast("업데이트…");
  await new Promise(r=>setTimeout(r,500));
  const incoming = [
    {name:"새로운 맛집 1",menu:"특제 덮밥",category:"korean",price:12000,distance:8},
    {name:"새로운 맛집 2",menu:"라멘",category:"japanese",price:13000,distance:10}
  ];
  let added=0;
  incoming.forEach(n=>{
    if(!restaurants.some(r=>normalize(r.name)===normalize(n.name))){
      restaurants.push(n); added++;
    }
  });
  if(added){ persist(); render(); }
  toast(`${added}개 추가됨`);
});

/* 추가 모달 */
const dlg = $("#addDlg");
$("#btnAdd").addEventListener("click",()=>dlg.showModal());
$("#addForm").addEventListener("submit",(e)=>{
  e.preventDefault();
  const name=$("#name").value, menu=$("#menu").value, category=$("#cat").value;
  const price=clampInt($("#price").value,0,1_000_000), distance=clampInt($("#dist").value,1,120);
  if(!name||!menu||!category){ toast("입력값을 확인하세요"); return; }
  if(restaurants.some(r=>normalize(r.name)===normalize(name))){ toast("이미 존재하는 식당"); return; }
  restaurants.push({name:name.trim(),menu:menu.trim(),category,price,distance});
  persist(); render(); dlg.close(); e.target.reset(); toast("추가 완료");
});

/* 단축키: / 로 검색 포커스 */
window.addEventListener("keydown",(e)=>{
  if(e.key==="/" && document.activeElement!==$("#q")){ e.preventDefault(); $("#q").focus(); }
});
</script>
</body>
</html>
